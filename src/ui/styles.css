/**
 * Termetrix Webview Styles (Optimized)
 */

/* Reset & Base */
* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 0;
  font-family: var(--vscode-font-family);
  font-size: var(--vscode-font-size);
  color: var(--vscode-foreground);
  background-color: var(--tmx-canvas, var(--vscode-editor-background));
}

/* Theme-derived surfaces */
:root {
  --tmx-canvas: var(--vscode-editor-background);
  --tmx-surface-1: var(--vscode-editorWidget-background, var(--vscode-sideBar-background));
  --tmx-surface-2: var(--vscode-editorWidget-background, var(--vscode-sideBar-background));
  --tmx-border: var(--vscode-panel-border);
}

@supports (color: color-mix(in srgb, white 50%, black)) {
  :root {
    --tmx-surface-1: color-mix(in srgb, var(--vscode-editor-background) 96%, var(--vscode-foreground) 4%);
    --tmx-surface-2: color-mix(in srgb, var(--vscode-editor-background) 92%, var(--vscode-foreground) 8%);
    --tmx-border: color-mix(in srgb, var(--vscode-panel-border) 85%, var(--vscode-foreground) 15%);
    --tmx-row-hover: var(--vscode-list-hoverBackground);
    --tmx-row-hover-border: var(--vscode-panel-border);
  }
}


/* App Layout */
.app {
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

.content {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 16px;
  overflow: hidden;
  gap: 12px;
}

.content.size-view,
.content.loc-view { gap: 16px; }

/* Tabs */
.tabs {
  display: flex;
  gap: 8px;
  padding: 10px 12px;
  border-bottom: 1px solid var(--tmx-border);
  background: var(--tmx-canvas);
}

.tabs button {
  flex: 1;
  background: var(--tmx-surface-1);
  border: 1px solid var(--tmx-border);
  border-radius: 6px;
  padding: 10px 12px;
  cursor: pointer;
  color: var(--vscode-foreground);
  opacity: 0.85;
  transition: opacity 0.15s, background 0.15s, border-color 0.15s;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.tabs button:hover { opacity: 1; background: var(--tmx-surface-2); }

.tabs button.active {
  opacity: 1;
  background: var(--tmx-surface-2);
  border-color: var(--vscode-focusBorder);
  font-weight: 600;
}

.tabs button:focus-visible,
.tmx-icon-button:focus-visible,
.tmx-row:focus-visible {
  outline: 2px solid var(--vscode-focusBorder);
  outline-offset: 1px;
}

/* Card primitives */
.tmx-header-card {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 14px 14px 12px;
  background: var(--tmx-surface-2);
  border: 1px solid var(--tmx-border);
  border-radius: 6px;
}

.tmx-panel-card {
  flex: 1;
  display: flex;
  flex-direction: column;
  position: relative;
  background: var(--tmx-surface-1);
  border: 1px solid var(--tmx-border);
  border-radius: 6px;
  min-height: 0;
}

.tmx-panel-fixed {
  gap: 8px;
  padding: 8px;
  overflow: hidden;
}

.tmx-panel-scroll {
  gap: 8px;
  padding: 8px;
  overflow-y: auto;
}

.tmx-panel-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  color: var(--vscode-foreground);
  background: rgba(0, 0, 0, 0.08);
  opacity: 0.9;
}

.tmx-hero { display: flex; flex-direction: column; gap: 10px; }

.tmx-hero-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.tmx-metrics-line {
  display: flex;
  align-items: baseline;
  flex-wrap: wrap;
  gap: 10px;
  min-width: 0;
}

.tmx-metric-primary {
  display: inline-flex;
  align-items: baseline;
  gap: 8px;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.tmx-metric-primaryIcon { transform: translateY(2px); }

.tmx-metric-primaryValue {
  font-size: 22px;
  line-height: 1.1;
  font-weight: 750;
  letter-spacing: -0.02em;
  font-variant-numeric: tabular-nums;
}

.tmx-metric-secondary {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  opacity: 0.8;
  font-size: 12px;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.tmx-metric-actions {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
}

.tmx-caption {
  display: block;
  opacity: 0.75;
  font-size: 12px;
}

.tmx-metric-sep {
  opacity: 0.5;
  display: inline-flex;
  align-items: center;
}

.tmx-icon-button {
  flex-shrink: 0;
  width: 34px;
  height: 34px;
  padding: 0;
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: 1px solid var(--vscode-button-border, var(--tmx-border));
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.1s, border-color 0.1s, transform 0.06s ease;
}

.tmx-icon-button:hover:not(:disabled) { background: var(--vscode-button-hoverBackground); }
.tmx-icon-button:active:not(:disabled) { transform: translateY(1px); }
.tmx-icon-button:disabled { opacity: 0.5; cursor: not-allowed; }

/* Interactive rows */
.tmx-row {
  background: transparent;
  border: 1px solid transparent;
  color: inherit;
  font: inherit;
  text-align: left;
  cursor: pointer;
}

.tmx-row:hover {
  background: var(--tmx-row-hover, var(--vscode-list-hoverBackground));
  border-color: var(--tmx-row-hover-border, var(--tmx-border));
}

.tmx-row:focus-visible { border-color: transparent; }

/* Banners */
.warning-banner,
.error-banner {
  margin: 0 0 8px;
  padding: 10px 14px;
  border-left: 3px solid;
  font-size: 13px;
  border-radius: 4px;
}

.warning-banner {
  background: var(--vscode-inputValidation-warningBackground);
  border-color: var(--vscode-inputValidation-warningBorder);
  color: var(--vscode-inputValidation-warningForeground);
  display: flex;
  align-items: center;
  gap: 8px;
}

.error-banner {
  padding: 12px 14px;
  background: var(--vscode-inputValidation-errorBackground);
  border-color: var(--vscode-inputValidation-errorBorder);
  color: var(--vscode-inputValidation-errorForeground);
  display: flex;
  align-items: flex-start;
  gap: 10px;
}

.error-banner-icon { flex-shrink: 0; margin-top: 1px; }

.error-banner-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.error-banner-message { font-weight: 500; }
.error-banner-details { font-size: 0.95em; opacity: 0.9; }

.error-banner-dismiss {
  flex-shrink: 0;
  background: transparent;
  border: none;
  padding: 4px;
  cursor: pointer;
  color: inherit;
  opacity: 0.7;
  transition: opacity 0.15s;
  border-radius: 4px;
}

.error-banner-dismiss:hover { opacity: 1; background: rgba(255, 255, 255, 0.1); }

/* Size Chart */
.size-chart {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.size-chart.empty { align-items: center; justify-content: center; }

.size-chart-row {
  position: relative;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 4px;
  overflow: hidden;
}

.size-chart-row.parent { font-weight: 500; }

.size-chart-row.child {
  padding-left: 24px;
  opacity: 0.85;
  font-size: 0.95em;
}

.size-chart-row.child .size-chart-name::before { content: "└ "; opacity: 0.5; }

.size-chart-row.file {
  padding-left: 44px;
  opacity: 0.78;
  font-size: 0.9em;
}

.size-chart-row.file .size-chart-name::before { content: "└ "; opacity: 0.45; }

.size-chart-bar {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  background: var(--vscode-progressBar-background);
  opacity: 0.3;
  border-radius: 4px;
  transition: width 0.2s ease;
}

.size-chart-row:hover .size-chart-bar { opacity: 0.5; }

.size-chart-name,
.file-path {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-family: var(--vscode-editor-font-family);
  position: relative;
  z-index: 1;
}

.size-chart-icon {
  position: relative;
  z-index: 1;
  opacity: 0.9;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.size-chart-value,
.lang-count,
.lang-percent {
  text-align: right;
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
}

.size-chart-value {
  font-size: 12px;
  position: relative;
  z-index: 1;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  line-height: 1.15;
}

.size-chart-bytes { font-variant-numeric: tabular-nums; }
.size-chart-meta { opacity: 0.7; font-size: 11px; }

.size-chart-percent { opacity: 0.6; margin-left: 4px; }

/* LOC View */
.loc-primary-suffix { opacity: 0.75; font-size: 12px; }

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.empty-state.variant-page { padding: 48px 24px; min-height: 400px; flex: 1; }
.empty-state.variant-panel { min-height: 240px; padding: 36px 24px; }
.empty-state.variant-inline { padding: 18px 16px; opacity: 0.8; }

.empty-state h2 { margin: 16px 0 8px; font-size: 1.4em; }
.empty-state p { margin: 8px 0; opacity: 0.8; }
.empty-state .hint { margin-top: 16px; font-size: 0.9em; opacity: 0.7; }

.section { margin-bottom: 32px; }
.section h4 { margin: 0 0 12px; font-size: 1.1em; opacity: 0.9; }

.language-row {
  display: grid;
  grid-template-columns: 1fr auto auto auto;
  gap: 12px;
  align-items: center;
  margin-bottom: 8px;
}

.bar-container {
  height: 20px;
  background: var(--vscode-input-background);
  border-radius: 4px;
  overflow: hidden;
}

.bar { height: 100%; background: var(--vscode-charts-blue); transition: width 0.3s ease; }

.lang-name { min-width: 100px; font-weight: 500; }
.lang-count { min-width: 80px; }
.lang-percent { min-width: 50px; opacity: 0.7; font-size: 0.9em; }

.file-row {
  appearance: none;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  padding: 8px;
  border-radius: 4px;
  width: 100%;
}

.file-path { font-size: 0.95em; }
.file-lines { margin-left: 16px; opacity: 0.7; font-variant-numeric: tabular-nums; }

/* Spinner */
.spinner { display: inline-block; animation: spin 1s linear infinite; }

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Error Boundary */
.error-boundary {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 24px;
}

.error-boundary-content {
  display: flex;
  flex-direction: column;
  max-width: 500px;
  text-align: center;
  align-items: center;
  gap: 16px;
}

.error-icon { color: var(--vscode-errorForeground); opacity: 0.9; }
.error-boundary h2 { margin: 0; font-size: 1.5em; font-weight: 600; }
.error-message { margin: 0; opacity: 0.85; font-size: 0.95em; }

.error-reset-button {
  margin-top: 8px;
  padding: 10px 20px;
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: background 0.15s;
}

.error-reset-button:hover { background: var(--vscode-button-hoverBackground); }

.error-details { margin-top: 16px; text-align: left; width: 100%; }

.error-details summary {
  cursor: pointer;
  padding: 8px;
  background: var(--tmx-surface-1);
  border-radius: 4px;
  font-size: 0.9em;
  opacity: 0.8;
}

.error-details summary:hover { opacity: 1; }

.error-details pre {
  margin: 8px 0 0;
  padding: 12px;
  background: var(--tmx-surface-2);
  border: 1px solid var(--tmx-border);
  border-radius: 4px;
  overflow-x: auto;
  font-size: 0.85em;
  opacity: 0.9;
}

/* Responsive */
@media (max-width: 520px) {
  .tmx-hero-row { align-items: flex-start; flex-direction: column; gap: 10px; }
  .tmx-metric-actions { align-self: flex-end; }
  .tmx-metric-primaryValue { font-size: 20px; }
}
